<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>India Income Tax Calculator — Old vs New Regime</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="Compare your income tax under India's old and new tax regimes for FY 2024-25 and FY 2025-26. No data stored.">
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cpath fill='%230ea5e9' d='M8 12h48v8H8zM8 28h48v8H8zM8 44h48v8H8z'/%3E%3C/svg%3E">
  <style>
    .card{ @apply bg-white rounded-2xl shadow-lg p-5 md:p-7 border border-slate-100; }
    .k { @apply font-semibold text-slate-600; }
    .v { @apply text-slate-900; }
    .pill { @apply inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-medium bg-sky-50 text-sky-700 border border-sky-200; }
    .num { font-variant-numeric: tabular-nums; }
    .muted { @apply text-slate-500; }
    .btn { @apply inline-flex items-center justify-center rounded-xl px-4 py-2 font-semibold border shadow-sm bg-slate-900 text-white hover:bg-slate-800 active:scale-[.98]; }
    .btn-ghost { @apply inline-flex items-center justify-center rounded-xl px-4 py-2 font-semibold border bg-white hover:bg-slate-50; }
    .grid2 { @apply grid grid-cols-1 md:grid-cols-2 gap-4; }
    .grid3 { @apply grid grid-cols-1 md:grid-cols-3 gap-4; }
    .grid4 { @apply grid grid-cols-1 lg:grid-cols-4 gap-4; }
    .input { @apply w-full rounded-xl border border-slate-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-300; }
    .label { @apply text-sm text-slate-600 mb-1; }
  </style>
</head>
<body class="bg-slate-50 text-slate-900">
  <header class="max-w-6xl mx-auto p-4 md:p-6">
    <div class="flex items-center justify-between">
      <h1 class="text-2xl md:text-3xl font-bold">India Income Tax Calculator <span class="text-sky-600">Old vs New</span></h1>
      <a class="btn-ghost" href="https://github.com/new" target="_blank" rel="noopener">Deploy on GitHub Pages →</a>
    </div>
    <p class="muted mt-2">Compare tax under the <b>Old</b> and <b>New</b> regimes for <b>FY 2024–25</b> (AY 2025–26) and <b>FY 2025–26</b> (AY 2026–27). Includes Health & Education Cess (4%).
      This tool ignores surcharge/marginal relief and special-rate incomes by default (you can toggle them).</p>
  </header>

  <main class="max-w-6xl mx-auto p-4 md:p-6 grid2">
    <!-- LEFT: Inputs -->
    <section class="card">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-semibold">Your Details</h2>
        <span id="statusPill" class="pill">FY 2024–25</span>
      </div>

      <div class="grid2">
        <div>
          <label class="label">Financial Year</label>
          <select id="fy" class="input">
            <option value="2024">FY 2024–25 (AY 2025–26)</option>
            <option value="2025">FY 2025–26 (AY 2026–27)</option>
          </select>
        </div>
        <div>
          <label class="label">Resident Status</label>
          <select id="resident" class="input">
            <option value="resident">Resident Individual</option>
            <option value="nri">Non-Resident Individual</option>
          </select>
        </div>
        <div>
          <label class="label">Age (Old regime only)</label>
          <select id="age" class="input">
            <option value="lt60">Below 60</option>
            <option value="60to80">60–79</option>
            <option value="80plus">80+</option>
          </select>
        </div>
        <div>
          <label class="label">Income Type</label>
          <select id="incomeType" class="input">
            <option value="salary">Salary/Pension</option>
            <option value="other">Other (no std. deduction)</option>
          </select>
        </div>
      </div>

      <div class="grid2 mt-4">
        <div>
          <label class="label">Annual Gross Income (₹)</label>
          <input id="gross" type="number" class="input" value="1200000" min="0" step="1000" />
        </div>
        <div>
          <label class="label">Other Income (₹)</label>
          <input id="otherIncome" type="number" class="input" value="0" min="0" step="1000" />
        </div>
      </div>

      <details class="mt-4">
        <summary class="cursor-pointer text-sm font-semibold">▶ Optional: Deductions (Old Regime)</summary>
        <div class="grid3 mt-3">
          <div>
            <label class="label">80C (PF/ELSS etc.) (₹)</label>
            <input id="d80c" type="number" class="input" value="150000" min="0" step="1000" />
          </div>
          <div>
            <label class="label">80D (Health Insurance) (₹)</label>
            <input id="d80d" type="number" class="input" value="25000" min="0" step="1000" />
          </div>
          <div>
            <label class="label">Home Loan Interest (Self-occupied) (₹)</label>
            <input id="d24b" type="number" class="input" value="0" min="0" step="1000" />
          </div>
        </div>
        <p class="muted mt-2 text-xs">Caps applied: 80C ≤ 1.5L, 80D ≤ 25k (below 60) or 50k (60+), Home Loan Interest (self-occupied) ≤ 2L.</p>
      </details>

      <details class="mt-3">
        <summary class="cursor-pointer text-sm font-semibold">▶ Optional: Special-rate income</summary>
        <div class="grid3 mt-3">
          <div>
            <label class="label">STCG (111A) at 15% (₹)</label>
            <input id="stcg111a" type="number" class="input" value="0" min="0" step="1000" />
          </div>
          <div>
            <label class="label">LTCG (112A) at 10% (₹)</label>
            <input id="ltcg112a" type="number" class="input" value="0" min="0" step="1000" />
          </div>
          <div class="flex items-end">
            <label class="inline-flex items-center gap-2 text-sm">
              <input id="applyRebateOnSpecial" type="checkbox" class="rounded" />
              Allow 87A rebate on special-rate income (generally <span class="italic">not</span> allowed)
            </label>
          </div>
        </div>
        <p class="muted mt-2 text-xs">Note: As per current practice, Section 87A rebate does <b>not</b> apply to tax on special-rate incomes in the new regime. Keep this unchecked for realistic results.</p>
      </details>

      <div class="mt-6 flex gap-3">
        <button id="calcBtn" class="btn">Calculate</button>
        <button id="shareBtn" class="btn-ghost">Share Settings</button>
        <button id="resetBtn" class="btn-ghost">Reset</button>
      </div>
    </section>

    <!-- RIGHT: Results -->
    <section class="card">
      <h2 class="text-xl font-semibold mb-2">Results</h2>
      <div class="grid2">
        <div class="p-4 rounded-xl bg-sky-50 border border-sky-200">
          <div class="muted text-xs">Old Regime</div>
          <div id="oldTax" class="text-2xl md:text-3xl font-bold num">—</div>
          <div id="oldEff" class="muted">Effective rate: —</div>
        </div>
        <div class="p-4 rounded-xl bg-emerald-50 border border-emerald-200">
          <div class="muted text-xs">New Regime</div>
          <div id="newTax" class="text-2xl md:text-3xl font-bold num">—</div>
          <div id="newEff" class="muted">Effective rate: —</div>
        </div>
      </div>

      <div class="mt-4">
        <div class="text-sm mb-2 font-semibold">Breakup</div>
        <div class="grid2">
          <div>
            <table class="w-full text-sm">
              <thead>
                <tr class="text-left text-slate-500">
                  <th class="py-1">Component (Old)</th>
                  <th class="py-1 text-right">Amount (₹)</th>
                </tr>
              </thead>
              <tbody id="oldBreak"></tbody>
            </table>
          </div>
          <div>
            <table class="w-full text-sm">
              <thead>
                <tr class="text-left text-slate-500">
                  <th class="py-1">Component (New)</th>
                  <th class="py-1 text-right">Amount (₹)</th>
                </tr>
              </thead>
              <tbody id="newBreak"></tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="mt-4">
        <div id="suggestion" class="text-sm"></div>
      </div>

      <div class="mt-6">
        <button id="downloadBtn" class="btn-ghost">Download .CSV</button>
      </div>

      <p class="muted mt-6 text-xs">Disclaimer: This tool is for quick estimation. For incomes with surcharge, business income, complex allowances or capital gains, consult a tax professional. No data is sent anywhere; all calculations run in your browser.</p>
    </section>
  </main>

  <footer class="max-w-6xl mx-auto p-4 md:p-6 text-center text-xs text-slate-500">
    Made with ❤ — MIT Licensed. <a class="underline" href="https://github.com">Host on GitHub Pages</a>
  </footer>

<script>
// ---------- Helpers ----------
const Rs = n => n.toLocaleString('en-IN', {maximumFractionDigits: 0});
const clamp = (n, min, max) => Math.max(min, Math.min(max, n));
const val = id => Number(document.getElementById(id).value || 0);
const setText = (id, text) => document.getElementById(id).textContent = text;
const row = (k,v) => `<tr><td class='py-1 pr-2 text-slate-600'>${k}</td><td class='py-1 text-right num'>${Rs(v)}</td></tr>`;

function getParams(){
  const p = new URLSearchParams(location.search);
  ['fy','resident','age','incomeType','gross','otherIncome','d80c','d80d','d24b','stcg111a','ltcg112a','applyRebateOnSpecial']
    .forEach(id=>{
      const el = document.getElementById(id);
      if(!el) return;
      const v = p.get(id);
      if(v!==null){
        if(el.type==='checkbox') el.checked = v==='1';
        else el.value = v;
      }
    });
}
function setParams(){
  const p = new URLSearchParams();
  ['fy','resident','age','incomeType','gross','otherIncome','d80c','d80d','d24b','stcg111a','ltcg112a']
    .forEach(id=>p.set(id, document.getElementById(id).value));
  p.set('applyRebateOnSpecial', document.getElementById('applyRebateOnSpecial').checked?'1':'0');
  history.replaceState(null,'',`?${p.toString()}`);
}

// ---------- Tax Logic ----------
function compute(){
  setParams();
  const fy = document.getElementById('fy').value; // '2024' or '2025'
  const resident = document.getElementById('resident').value;
  const age = document.getElementById('age').value;
  const incomeType = document.getElementById('incomeType').value;

  const gross = val('gross');
  const other = val('otherIncome');
  const totalIncome = Math.max(0, gross + other);

  const stcg = val('stcg111a');
  const ltcg = val('ltcg112a');
  const allowRebateOnSpecial = document.getElementById('applyRebateOnSpecial').checked;

  // Old regime deductions
  let d80c = clamp(val('d80c'), 0, 150000);
  let d80dCap = (age==='lt60'?25000:50000);
  let d80d = clamp(val('d80d'), 0, d80dCap);
  let d24b = clamp(val('d24b'), 0, 200000);
  const stdOld = (incomeType==='salary') ? 50000 : 0; // Std deduction old

  const totalDedOld = stdOld + d80c + d80d + d24b;
  const taxableOldRegular = Math.max(0, totalIncome - totalDedOld - stcg - ltcg);

  // New regime standard deduction
  const stdNew = (incomeType==='salary') ? (fy==='2025' ? 75000 : 50000) : 0;
  const totalDedNew = stdNew; // ignoring 80C/80D etc. under new regime
  const taxableNewRegular = Math.max(0, totalIncome - totalDedNew - stcg - ltcg);

  // Slabs
  function taxOldRegular(amount){
    // Age-based slabs for OLD regime
    let slabs;
    if(age==='80plus') slabs = [[0,500000,0],[500000,1000000,0.20],[1000000,Infinity,0.30]];
    else if(age==='60to80') slabs = [[0,300000,0],[300000,500000,0.05],[500000,1000000,0.20],[1000000,Infinity,0.30]];
    else slabs = [[0,250000,0],[250000,500000,0.05],[500000,1000000,0.20],[1000000,Infinity,0.30]];
    return slabTax(amount, slabs);
  }
  function taxNewRegular(amount){
    if(fy==='2025'){
      // Proposed/enacted FY 2025-26 slabs under NEW regime
      const slabs = [
        [0,400000,0],[400000,800000,0.05],[800000,1200000,0.10],[1200000,1600000,0.15],
        [1600000,2000000,0.20],[2000000,2400000,0.25],[2400000,Infinity,0.30]
      ];
      return slabTax(amount, slabs);
    } else {
      const slabs = [[0,300000,0],[300000,600000,0.05],[600000,900000,0.10],[900000,1200000,0.15],[1200000,1500000,0.20],[1500000,Infinity,0.30]];
      return slabTax(amount, slabs);
    }
  }
  function slabTax(amount, slabs){
    let tax = 0;
    for(const [a,b,r] of slabs){
      if(amount>a){
        const chunk = Math.min(amount,b)-a;
        tax += chunk * r;
      }
    }
    return Math.max(0, Math.floor(tax));
  }

  // Regular slab tax (excludes special rate incomes)
  const oldRegTax = taxOldRegular(taxableOldRegular);
  const newRegTax = taxNewRegular(taxableNewRegular);

  // Special-rate taxes
  const stcgTaxOld = Math.max(0, Math.floor(stcg * 0.15));
  // LTCG 112A: first 1L exempt
  const ltcgTaxable = Math.max(0, ltcg - 100000);
  const ltcgTaxOld = Math.floor(ltcgTaxable * 0.10);
  const stcgTaxNew = stcgTaxOld; // same rates assumed
  const ltcgTaxNew = ltcgTaxOld;

  // Combine before rebate & cess
  let oldTaxBeforeRebate = oldRegTax + stcgTaxOld + ltcgTaxOld;
  let newTaxBeforeRebate = newRegTax + stcgTaxNew + ltcgTaxNew;

  // 87A rebate (Resident individuals only)
  function apply87A_old(regTax, totalTax, taxableRegular){
    if(resident !== 'resident') return totalTax; // NRIs not eligible
    // Under old regime: rebate up to 12,500 if total taxable income <= 5L (regular inclusive)
    if(taxableRegular <= 500000){
      const rebate = Math.min(12500, totalTax);
      return totalTax - rebate;
    }
    return totalTax;
  }
  function apply87A_new(regTax, totalTax, taxableRegular){
    if(resident !== 'resident') return totalTax;
    if(fy==='2025'){
      // FY 2025-26: rebate up to 60,000 for net taxable income <= 12,00,000
      if(taxableRegular <= 1200000){
        // Typically rebate does NOT apply to special-rate taxes
        const base = allowRebateOnSpecial ? totalTax : regTax;
        const rebate = Math.min(60000, base);
        // Reduce appropriate component
        if(allowRebateOnSpecial) return totalTax - rebate; else return (totalTax - Math.min(rebate, regTax));
      }
      return totalTax;
    } else {
      // FY 2024-25: rebate up to 25,000 for net taxable income <= 7,00,000
      if(taxableRegular <= 700000){
        const base = allowRebateOnSpecial ? totalTax : regTax;
        const rebate = Math.min(25000, base);
        if(allowRebateOnSpecial) return totalTax - rebate; else return (totalTax - Math.min(rebate, regTax));
      }
      return totalTax;
    }
  }

  const oldAfterRebate = apply87A_old(oldRegTax, oldTaxBeforeRebate, taxableOldRegular + stcg + ltcg);
  const newAfterRebate = apply87A_new(newRegTax, newTaxBeforeRebate, taxableNewRegular + stcg + ltcg);

  // Cess @ 4%
  const oldCess = Math.floor(oldAfterRebate * 0.04);
  const newCess = Math.floor(newAfterRebate * 0.04);

  const oldTotal = oldAfterRebate + oldCess;
  const newTotal = newAfterRebate + newCess;

  // Update UI
  setText('statusPill', (fy==='2025'?'FY 2025–26':'FY 2024–25'));
  setText('oldTax', `₹ ${Rs(oldTotal)}`);
  setText('newTax', `₹ ${Rs(newTotal)}`);
  setText('oldEff', `Effective rate: ${(oldTotal / Math.max(1,totalIncome) * 100).toFixed(2)}%`);
  setText('newEff', `Effective rate: ${(newTotal / Math.max(1,totalIncome) * 100).toFixed(2)}%`);

  // Breakups
  const oldBreak = document.getElementById('oldBreak');
  const newBreak = document.getElementById('newBreak');
  oldBreak.innerHTML = '';
  newBreak.innerHTML = '';
  oldBreak.insertAdjacentHTML('beforeend', row('Gross Total Income', totalIncome));
  oldBreak.insertAdjacentHTML('beforeend', row('Std. Deduction', -stdOld));
  oldBreak.insertAdjacentHTML('beforeend', row('80C', -d80c));
  oldBreak.insertAdjacentHTML('beforeend', row('80D', -d80d));
  oldBreak.insertAdjacentHTML('beforeend', row('Home Loan Interest', -d24b));
  oldBreak.insertAdjacentHTML('beforeend', row('Taxable (regular)', taxableOldRegular));
  oldBreak.insertAdjacentHTML('beforeend', row('Slab tax (regular)', oldRegTax));
  if(stcg) oldBreak.insertAdjacentHTML('beforeend', row('STCG 111A @15%', stcgTaxOld));
  if(ltcg) oldBreak.insertAdjacentHTML('beforeend', row('LTCG 112A @10% (>1L)', ltcgTaxOld));
  oldBreak.insertAdjacentHTML('beforeend', row('Rebate 87A', -(oldTaxBeforeRebate - oldAfterRebate)));
  oldBreak.insertAdjacentHTML('beforeend', row('Cess @4%', oldCess));
  oldBreak.insertAdjacentHTML('beforeend', row('<b>Total Tax</b>', oldTotal));

  newBreak.insertAdjacentHTML('beforeend', row('Gross Total Income', totalIncome));
  newBreak.insertAdjacentHTML('beforeend', row('Std. Deduction', -stdNew));
  newBreak.insertAdjacentHTML('beforeend', row('Taxable (regular)', taxableNewRegular));
  newBreak.insertAdjacentHTML('beforeend', row('Slab tax (regular)', newRegTax));
  if(stcg) newBreak.insertAdjacentHTML('beforeend', row('STCG 111A @15%', stcgTaxNew));
  if(ltcg) newBreak.insertAdjacentHTML('beforeend', row('LTCG 112A @10% (>1L)', ltcgTaxNew));
  newBreak.insertAdjacentHTML('beforeend', row('Rebate 87A', -(newTaxBeforeRebate - newAfterRebate)));
  newBreak.insertAdjacentHTML('beforeend', row('Cess @4%', newCess));
  newBreak.insertAdjacentHTML('beforeend', row('<b>Total Tax</b>', newTotal));

  const better = oldTotal < newTotal ? 'Old' : (newTotal < oldTotal ? 'New' : 'Either');
  const diff = Math.abs(oldTotal - newTotal);
  document.getElementById('suggestion').innerHTML = `<div class='p-3 rounded-xl border ${better==='Old'?'border-sky-200 bg-sky-50':'border-emerald-200 bg-emerald-50'}'>
    <span class='font-semibold'>Recommendation:</span> <span class='num'>${better}</span> regime saves <b>₹ ${Rs(diff)}</b> based on your inputs.
  </div>`;

  return {
    fy, resident, age, incomeType, gross, other, stdOld, stdNew, d80c, d80d, d24b, taxableOldRegular, taxableNewRegular,
    oldRegTax, newRegTax, stcg, ltcg, stcgTaxOld, ltcgTaxOld, oldTotal, newTotal
  };
}

function downloadCSV(state){
  const lines = [
    ['Field','Value'],
    ['Financial Year', state.fy==='2025'?'FY 2025-26':'FY 2024-25'],
    ['Resident', state.resident],
    ['Age', state.age],
    ['Income Type', state.incomeType],
    ['Gross Income', state.gross],
    ['Other Income', state.other],
    ['Std Deduction Old', state.stdOld],
    ['Std Deduction New', state.stdNew],
    ['80C', state.d80c],
    ['80D', state.d80d],
    ['Home Loan Interest', state.d24b],
    ['Taxable Regular Old', state.taxableOldRegular],
    ['Taxable Regular New', state.taxableNewRegular],
    ['Slab Tax Old', state.oldRegTax],
    ['Slab Tax New', state.newRegTax],
    ['STCG 111A', state.stcg],
    ['LTCG 112A', state.ltcg],
    ['Total Tax Old', state.oldTotal],
    ['Total Tax New', state.newTotal]
  ];
  const csv = lines.map(r=>r.join(',')).join('\n');
  const blob = new Blob([csv],{type:'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'tax-comparison.csv'; a.click();
  URL.revokeObjectURL(url);
}

// ---------- Events ----------
getParams();
let st = compute();

document.getElementById('calcBtn').addEventListener('click', ()=> st = compute());
document.querySelectorAll('select,input').forEach(el=>{
  el.addEventListener('change', ()=> st = compute());
  el.addEventListener('input', ()=> st = compute());
});

document.getElementById('downloadBtn').addEventListener('click', ()=> downloadCSV(st));
document.getElementById('shareBtn').addEventListener('click', ()=>{
  setParams();
  navigator.clipboard.writeText(location.href).then(()=>{
    alert('Sharable link copied to clipboard!');
  });
});
document.getElementById('resetBtn').addEventListener('click', ()=>{
  location.href = location.pathname;
});
</script>
</body>
</html>
